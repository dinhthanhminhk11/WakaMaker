1. Get file zip epub
GET /static/ebook/0/0/1/35021_2_drm.epub HTTP/1.1
User-Agent: Dalvik/2.1.0 (Linux; U; Android 9; SM-G973N Build/PPR1.190810.011)
Host: waka.vn
Connection: Keep-Alive
Accept-Encoding: gzip


2. Get DRMKey
GET /getDRMKey?account=7919604&secure_code=e%2F8WRz%2BLvIQRVKmBnbGGvOfQ5j4%3D&content_id=35021_2_book&content_type=book&request_id=118871953&request_key=eyJjdHkiOiJKV1QiLCJlbmMiOiJBMTI4R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.Yol-ZnSTMs4EzUvpJfshNmP3dQnZDsbrtNUfgHbPz-FQM7Ioc78bpeNSWWiWzXP5ht43xzZ-bniIN1m44f4xpU82L_ZR2-n6ogConJvfUKrA1_nP8SXnVbfcm20UZm2VHRAfz5lZTbqGv8RRx0-BLZkqRhbcrRYNE06Wpgizr6kxFziNDEev4RAlcEqomX1NVgvLc4ilhJCUhY5h31DWTzk46qtNqqlGb_ZJQejZS3WyW9OKC6qN_65ygvkj9EpT2tqbKocQZKEpFad9ynDhsqUd1JeErQ69iX4Sb8f3g6t0HJ-z8vd6peExI8biBTK8BgC4tFmhuYMg3lA4r5me4w.AA9rxQHkG5u875vO.qrCu-IFSUN61EYGl2tThbwdoVJ_F9HoG1AjRH1tIL9MMbRBWctWnQbBbYT20W_CgEot9XaDL7hbWcWMma-pYW5nf_TlwS5Hq7rNlEQ0qIR5JnKN_Swjn-U3aliZWwXZnfrdJrjE0zjaLq9PUqYvXmvw9JFsVvaLIh9N1EmkWslvq0qkcpJIg-gfWPtzlo45PI9PJT7D2bQw6sAJ2Ky9ttrWzrPNyWQF61MYn4cpXWOdws8VEJEpq-nnyISVbmRtjysaQv9VBrttTo-Om_SjULVUTLwTTaHhbmPdOrVJZw6CJpZ3p97e5YddbGSas53GELqhJq1IytfmO_TJIZkkcKkUdWzXSfBx9RT5tnU6Fa2GwTwD8cE6QsMLlbvSOoaRptdFas2f0dS31bFbQPx1pss7KjfdglyW3WBFBeE0JI1VHcU0t38Y0IEK5JIh4uCFZ3Ga3va9BJiQ2VuPuwCuE58DjNTNFRzti-yutYBjM7TF_2AWlz464VRUz9Wr0tYIE7a6mZ1cznp3AbINDbyLdCjI8F-rg5g0wkM2ITRmqloCTL3e6swCezEg2ysF4pCjaBK4PsazCkkxAXOJjRmIf940ctlI8rKy9Jp8SlMJsV9ZdKzcAa9lE9-7tGTxs2YNS6d6iVnOVJQthupKJTOBBBer3IqpIGUKejUK-3gCem0yBd5W9mdK7efG0bJBQno_KhjewHDVxBN8c-yRe6EycuOA0BhzoA9xTS5ly092DhMqvukLAEuPXkFow4YB-Q5rq4Cn70w.HYjCayNjKHrMW_ECcQRcXg&os=android&app_version=8.0.7&id=e37fd0ffd452efed HTTP/1.1
type-ignore: class anim.dqh.tvw.model.DrmKeyObject
Host: beta-api.waka.vn
Connection: Keep-Alive
Accept-Encoding: gzip
User-Agent: okhttp/4.10.0

{
	"code": 0,
	"message": "Thành công",
	"drm_key": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6ImRhYTZmMDk3LTM3ZGQtNGE3Yy05NzAzLTQ0NzMxZDUzMmU0NSJ9.eyJpc3MiOiJ3YWthIiwiaWF0IjoxNjc5NDc4MjA1LCJqdGkiOiIxMTg4NzE5NTMiLCJzdWIiOiJleUpqZEhraU9pSktWMVFpTENKbGJtTWlPaUpCTVRJNFIwTk5JaXdpWVd4bklqb2lVbE5CTFU5QlJWQWlmUS5Zb2wtWm5TVE1zNEV6VXZwSmZzaE5tUDNkUW5aRHNicnROVWZnSGJQei1GUU03SW9jNzhicGVOU1dXaVd6WFA1aHQ0M3h6Wi1ibmlJTjFtNDRmNHhwVTgyTF9aUjItbjZvZ0Nvbkp2ZlVLckExX25QOFNYblZiZmNtMjBVWm0yVkhSQWZ6NWxaVGJxR3Y4UlJ4MC1CTFprcVJoYmNyUllORTA2V3BnaXpyNmt4RnppTkRFZXY0UkFsY0Vxb21YMU5WZ3ZMYzRpbGhKQ1VoWTVoMzFEV1R6azQ2cXROcXFsR2JfWkpRZWpaUzNXeVc5T0tDNnFOXzY1eWd2a2o5RXBUMnRxYktvY1FaS0VwRmFkOXluRGhzcVVkMUplRXJRNjlpWDRTYjhmM2c2dDBISi16OHZkNnBlRXhJOGJpQlRLOEJnQzR0Rm1odVlNZzNsQTRyNW1lNHcuQUE5cnhRSGtHNXU4NzV2Ty5xckN1LUlGU1VONjFFWUdsMnRUaGJ3ZG9WSl9GOUhvRzFBalJIMXRJTDlNTWJSQldjdFduUWJCYllUMjBXX0NnRW90OVhhREw3aGJXY1dNbWEtcFlXNW5mX1Rsd1M1SHE3ck5sRVEwcUlSNUpuS05fU3dqbi1VM2FsaVpXd1habmZyZEpyakUwemphTHE5UFVxWXZYbXZ3OUpGc1Z2YUxJaDlOMUVta1dzbHZxMHFrY3BKSWctZ2ZXUHR6bG80NVBJOVBKVDdEMmJRdzZzQUoyS3k5dHRyV3pyUE55V1FGNjFNWW40Y3BYV09kd3M4VkVKRXBxLW5ueUlTVmJtUnRqeXNhUXY5VkJydHRUby1PbV9TalVMVlVUTHdUVGFIaGJtUGRPclZKWnc2Q0pwWjNwOTdlNVlkZGJHU2FzNTNHRUxxaEpxMUl5dGZtT19USklaa2tjS2tVZFd6WFNmQng5UlQ1dG5VNkZhMkd3VHdEOGNFNlFzTUxsYnZTT29hUnB0ZEZhczJmMGRTMzFiRmJRUHgxcHNzN0tqZmRnbHlXM1dCRkJlRTBKSTFWSGNVMHQzOFkwSUVLNUpJaDR1Q0ZaM0dhM3ZhOUJKaVEyVnVQdXdDdUU1OERqTlRORlJ6dGkteXV0WUJqTTdURl8yQVdsejQ2NFZSVXo5V3IwdFlJRTdhNm1aMWN6bnAzQWJJTkRieUxkQ2pJOEYtcmc1ZzB3a00ySVRSbXFsb0NUTDNlNnN3Q2V6RWcyeXNGNHBDamFCSzRQc2F6Q2treEFYT0pqUm1JZjk0MGN0bEk4ckt5OUpwOFNsTUpzVjlaZEt6Y0FhOWxFOS03dEdUeHMyWU5TNmQ2aVZuT1ZKUXRodXBLSlRPQkJCZXIzSXFwSUdVS2VqVUstM2dDZW0weUJkNVc5bWRLN2VmRzBiSkJRbm9fS2hqZXdIRFZ4Qk44Yy15UmU2RXljdU9BMEJoem9BOXhUUzVseTA5MkRoTXF2dWtMQUV1UFhrRm93NFlCLVE1cnE0Q243MHcuSFlqQ2F5TmpLSHJNV19FQ2NRUmNYZyIsImEiOiI3OTE5NjA0IiwiZCI6IjAiLCJyIjoiMzUwMjFfMl9ib29rIiwiZSI6MCwiZXhwIjoxNjc5NTY0NjA1fQ.U4jTLokH9NFQLx8sEyqf5sf7Z2ZnOAy5AyY26f8UXs82iXIE98sbm81c7Ta2JJafyFWViXSOKWiSH8mLP_LQDYvxVneeJglTUA5ZDXynyjwkeoBuZelfH1IVZSJ_5mmDIkq9r-us8WyOxjLCqK9qTh6dNk9B4O3dHq6kmUVcdSAAuMvjfoNof_-vcmAJabFaZ5EJcpHjpll2Pu8qtrSBFOr0z5QOkcXVJp1ravsEz9oJBWffNLPDfXMxd8ZMOHMPrymaGoVEBuKola1d7xH5X4bOQYDs-lF0g4QrwJjyftAqxvtmiXIzomxkIccbS21vvx7NoopmgHbdPkOVOyhtOg"
}

3. Request license decrypt
http://drm3.ovp.vn/

POST / HTTP/1.1
Content-Type: text/plain; charset=utf-8
Content-Length: 2230
Host: drm3.ovp.vn
Accept-Encoding: gzip
User-Agent: okhttp/4.10.0
Connection: keep-alive

eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6ImRhYTZmMDk3LTM3ZGQtNGE3Yy05NzAzLTQ0NzMxZDUzMmU0NSJ9.eyJpc3MiOiJ3YWthIiwiaWF0IjoxNjc5NDc4MjA1LCJqdGkiOiIxMTg4NzE5NTMiLCJzdWIiOiJleUpqZEhraU9pSktWMVFpTENKbGJtTWlPaUpCTVRJNFIwTk5JaXdpWVd4bklqb2lVbE5CTFU5QlJWQWlmUS5Zb2wtWm5TVE1zNEV6VXZwSmZzaE5tUDNkUW5aRHNicnROVWZnSGJQei1GUU03SW9jNzhicGVOU1dXaVd6WFA1aHQ0M3h6Wi1ibmlJTjFtNDRmNHhwVTgyTF9aUjItbjZvZ0Nvbkp2ZlVLckExX25QOFNYblZiZmNtMjBVWm0yVkhSQWZ6NWxaVGJxR3Y4UlJ4MC1CTFprcVJoYmNyUllORTA2V3BnaXpyNmt4RnppTkRFZXY0UkFsY0Vxb21YMU5WZ3ZMYzRpbGhKQ1VoWTVoMzFEV1R6azQ2cXROcXFsR2JfWkpRZWpaUzNXeVc5T0tDNnFOXzY1eWd2a2o5RXBUMnRxYktvY1FaS0VwRmFkOXluRGhzcVVkMUplRXJRNjlpWDRTYjhmM2c2dDBISi16OHZkNnBlRXhJOGJpQlRLOEJnQzR0Rm1odVlNZzNsQTRyNW1lNHcuQUE5cnhRSGtHNXU4NzV2Ty5xckN1LUlGU1VONjFFWUdsMnRUaGJ3ZG9WSl9GOUhvRzFBalJIMXRJTDlNTWJSQldjdFduUWJCYllUMjBXX0NnRW90OVhhREw3aGJXY1dNbWEtcFlXNW5mX1Rsd1M1SHE3ck5sRVEwcUlSNUpuS05fU3dqbi1VM2FsaVpXd1habmZyZEpyakUwemphTHE5UFVxWXZYbXZ3OUpGc1Z2YUxJaDlOMUVta1dzbHZxMHFrY3BKSWctZ2ZXUHR6bG80NVBJOVBKVDdEMmJRdzZzQUoyS3k5dHRyV3pyUE55V1FGNjFNWW40Y3BYV09kd3M4VkVKRXBxLW5ueUlTVmJtUnRqeXNhUXY5VkJydHRUby1PbV9TalVMVlVUTHdUVGFIaGJtUGRPclZKWnc2Q0pwWjNwOTdlNVlkZGJHU2FzNTNHRUxxaEpxMUl5dGZtT19USklaa2tjS2tVZFd6WFNmQng5UlQ1dG5VNkZhMkd3VHdEOGNFNlFzTUxsYnZTT29hUnB0ZEZhczJmMGRTMzFiRmJRUHgxcHNzN0tqZmRnbHlXM1dCRkJlRTBKSTFWSGNVMHQzOFkwSUVLNUpJaDR1Q0ZaM0dhM3ZhOUJKaVEyVnVQdXdDdUU1OERqTlRORlJ6dGkteXV0WUJqTTdURl8yQVdsejQ2NFZSVXo5V3IwdFlJRTdhNm1aMWN6bnAzQWJJTkRieUxkQ2pJOEYtcmc1ZzB3a00ySVRSbXFsb0NUTDNlNnN3Q2V6RWcyeXNGNHBDamFCSzRQc2F6Q2treEFYT0pqUm1JZjk0MGN0bEk4ckt5OUpwOFNsTUpzVjlaZEt6Y0FhOWxFOS03dEdUeHMyWU5TNmQ2aVZuT1ZKUXRodXBLSlRPQkJCZXIzSXFwSUdVS2VqVUstM2dDZW0weUJkNVc5bWRLN2VmRzBiSkJRbm9fS2hqZXdIRFZ4Qk44Yy15UmU2RXljdU9BMEJoem9BOXhUUzVseTA5MkRoTXF2dWtMQUV1UFhrRm93NFlCLVE1cnE0Q243MHcuSFlqQ2F5TmpLSHJNV19FQ2NRUmNYZyIsImEiOiI3OTE5NjA0IiwiZCI6IjAiLCJyIjoiMzUwMjFfMl9ib29rIiwiZSI6MCwiZXhwIjoxNjc5NTY0NjA1fQ.U4jTLokH9NFQLx8sEyqf5sf7Z2ZnOAy5AyY26f8UXs82iXIE98sbm81c7Ta2JJafyFWViXSOKWiSH8mLP_LQDYvxVneeJglTUA5ZDXynyjwkeoBuZelfH1IVZSJ_5mmDIkq9r-us8WyOxjLCqK9qTh6dNk9B4O3dHq6kmUVcdSAAuMvjfoNof_-vcmAJabFaZ5EJcpHjpll2Pu8qtrSBFOr0z5QOkcXVJp1ravsEz9oJBWffNLPDfXMxd8ZMOHMPrymaGoVEBuKola1d7xH5X4bOQYDs-lF0g4QrwJjyftAqxvtmiXIzomxkIccbS21vvx7NoopmgHbdPkOVOyhtOg

Response:

mWl1n_1R4C-RuKJBYt5sXtVBttTBrnQzndxppYY1WjdSbdDzL5F_7VbaRY_-vR-llDvk6R1DL6V_ib22cKHo1H3Nb4wvjbKHakTzMFjc-gf9lflA_M2elX1qLGRiPl0XYNBjpXPVMn7R7NqO6oudtEVSjQwcJifoARdzMPVwUMn8KK2HqbSo5It4yWQ4uSRFEDdJIDZj48Yf4YMREzJ8DkZa_CjhEyqpuDprfs7e4pN18MT1cZ1KO7-jjIdnCy1kTIgUh5sp6CcytsBAE7o6S0TlZeQLI8V1bvcngb4Q1zJj7SGfdULtcO057watVq5itRdTblTydYyo0ILvH-lV6g$i1ykZb--vDyDdGqAQv1XnqHhHziNfkypOTmzljPwI6PIeDHeeIOMVN0ExYQb9CGH$wVnSTYj3uV0vxX2KeVAkdA


4. Giải mã license -> key giải mã file xhtml

mWl1n_1R4C-RuKJBYt5sXtVBttTBrnQzndxppYY1WjdSbdDzL5F_7VbaRY_-vR-llDvk6R1DL6V_ib22cKHo1H3Nb4wvjbKHakTzMFjc-gf9lflA_M2elX1qLGRiPl0XYNBjpXPVMn7R7NqO6oudtEVSjQwcJifoARdzMPVwUMn8KK2HqbSo5It4yWQ4uSRFEDdJIDZj48Yf4YMREzJ8DkZa_CjhEyqpuDprfs7e4pN18MT1cZ1KO7-jjIdnCy1kTIgUh5sp6CcytsBAE7o6S0TlZeQLI8V1bvcngb4Q1zJj7SGfdULtcO057watVq5itRdTblTydYyo0ILvH-lV6g$i1ykZb--vDyDdGqAQv1XnqHhHziNfkypOTmzljPwI6PIeDHeeIOMVN0ExYQb9CGH$wVnSTYj3uV0vxX2KeVAkdA

=>

mWl1n_1R4C-RuKJBYt5sXtVBttTBrnQzndxppYY1WjdSbdDzL5F_7VbaRY_-vR-llDvk6R1DL6V_ib22cKHo1H3Nb4wvjbKHakTzMFjc-gf9lflA_M2elX1qLGRiPl0XYNBjpXPVMn7R7NqO6oudtEVSjQwcJifoARdzMPVwUMn8KK2HqbSo5It4yWQ4uSRFEDdJIDZj48Yf4YMREzJ8DkZa_CjhEyqpuDprfs7e4pN18MT1cZ1KO7-jjIdnCy1kTIgUh5sp6CcytsBAE7o6S0TlZeQLI8V1bvcngb4Q1zJj7SGfdULtcO057watVq5itRdTblTydYyo0ILvH-lV6g
$
i1ykZb--vDyDdGqAQv1XnqHhHziNfkypOTmzljPwI6PIeDHeeIOMVN0ExYQb9CGH
$
wVnSTYj3uV0vxX2KeVAkdA

==>
String str = 
"mWl1n_1R4C-RuKJBYt5sXtVBttTBrnQzndxppYY1WjdSbdDzL5F_7VbaRY_-vR-llDvk6R1DL6V_ib22cKHo1H3Nb4wvjbKHakTzMFjc-gf9lflA_M2elX1qLGRiPl0XYNBjpXPVMn7R7NqO6oudtEVSjQwcJifoARdzMPVwUMn8KK2HqbSo5It4yWQ4uSRFEDdJIDZj48Yf4YMREzJ8DkZa_CjhEyqpuDprfs7e4pN18MT1cZ1KO7-jjIdnCy1kTIgUh5sp6CcytsBAE7o6S0TlZeQLI8V1bvcngb4Q1zJj7SGfdULtcO057watVq5itRdTblTydYyo0ILvH-lV6g";

Gọi hàm
byte[] keyDecryptXhtml = LicenseKeyDecryptorImpl.decryptLicenseKey(str);

Convert file xhtml => byte[]
byte[] data = FileUtils.readFileToByteArray(new File("C:\\page0004.xhtml"));

byte[] byteGiaiMax = Test1.decrypt(keyDecryptXhtml, data);
String htmlContent = new String(byteGiaiMax);
